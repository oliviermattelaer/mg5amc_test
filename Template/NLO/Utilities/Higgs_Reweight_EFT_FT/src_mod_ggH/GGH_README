#!- tested for: aMC_MG5_v2_2_3 with HC_NLO_X0_UFO-heft model -!#

This script builds masseffects in the SM, MSSM and 2HDM effects for the 
gluon fusion process (g g > h) on top of the heavy-effective-theory 
(heft), which is available by default in MG5_aMC, at NLO QCD. The 
Matrixelements are taken from SusHi (http://sushi.hepforge.org/), 
which has to be downloaded together with FeynHiggs 
(http://www.feynhiggs.de/) separately. This script copies the modified 
MG5_aMC files and links SusHi and FeyHiggs. 

The first argument has to be set to the path (ggH-path) of a folder  
containing g g > H (heft) at NLO created by MG5_aMC. The second argu-
ment can be set to the path of the lib folder of SusHi and the third 
argument to the path of the lib folder of FeynHiggs. If either of these 
paths are not set, the script will ask you to type them. If either path 
does not exist or you leave them empty, you have to link the missing 
libraries libsushiFH.a/libFH.a by hand to the lib folder in your 
ggH-folder. The new version of the Script automatically downloads and 
installs FeynHiggs and SusHi for you.

Instructions to set up everything from scratch (>= MG5_aMC_v2_2_3):

1. Create folder for g g > h with MG5_aMC in heft model:
- go into MG5_aMC folder
> cd /path/to/MG5_aMC/MG5_aMC_v2_1_2

- start MG5_aMC by typing
> ./bin/mg5_aMC

- continue with the following steps:
MG5_aMC>import model HC_NLO_X0_UFO-heft 
MG5_aMC>define p = p b b~
MG5_aMC>define j = p
MG5_aMC>generate p p > x0 / t [real=QCD] @0
MG5_aMC>add process p p > x0 j / t [QCD] @1
MG5_aMC>(*maybe later* add process p p > x0 j j / t [QCD] @2)
MG5_aMC>output ggh-folder
MG5_aMC>exit

Note: The "/ t" option is crucial in order to have the script replace 
      files in the correct sub-process folder.

This creates a folder /path/to/MG5_aMC/MG5_aMC_v2_2_3/ggH-folder 
containing the process. Not including the virtuals by [real=QCD] does 
not matter, since the script will replace all matrixelements anyway, 
thus ignore the warning.

The following steps are not required any more. Simply go to the 
src_mod_ggH folder and run the script with the ggH-folder as first 
argument:

> ./set_up_ggH_MSSM_script.pl /path/to/ggH-folder

and follow the instructions on the screen to download SusHi and 
FeynHiggs automatically.

-----------------------------------------------------------------------
old way (still works):

2. create FeynHiggs library:
- goto folder where you want to install FeynHiggs
> cd /path/to/FeynHiggs

- download FeynHiggs (version 2.10.0 or higher, current: 2.10.1) from 
  http://www.feynhiggs.de/ or type
> curl -O http://wwwth.mpp.mpg.de/members/heinemey/feynhiggs/newversion/FeynHiggs-X.X.X.tar.gz
> tar -xf FeynHiggs-X.X.X.tar.gz
> cd FeynHiggs-X.X.X

- compile FeynHiggs
> ./configure FC=gfortran
> make
> make install

[optional:
you might want to configure with
> ./configure FC=gfortran FFLAGS=-mcmodel=large
instead, otherwise you might (depends on compiler version) get 
errors of the form "relocation truncated to fit: R_X86_64_32S" 
when running MG5_aMC later.
]

libFH.a will be in /path/to/FeynHiggs/FeynHiggs-X.X.X/<prefix>/lib 
(or lib64), where <prefix> is by default the same as the HOSTTYPE 
environment variable (e.g. x86_64-Darwin or x86_64-linux)

3. create SusHi library:
- goto folder where you want to install SusHi
> cd /path/to/SusHi

- download SusHi (version 1.3.0 or higher) from 
  http://sushi.hepforge.org, or type 
> curl -O https://www.hepforge.org/archive/sushi/SusHi-X.X.X.tar.gz
> tar -xf SusHi-X.X.X.tar.gz
> cd SusHi-X.X.X

- set path for FeynHiggs in Makefile (this is not necessary, if you 
  ignore the error after "make" the library should still be there) 
  and type
> ./configure F77=gfortran
> make predef=FH

[optional:
you might want to configure with
> ./configure F77=gfortran F77FLAGS=-mcmodel=large
instead, otherwise you might (depends on compiler version) get 
errors of the form "relocation truncated to fit: R_X86_64_32S" 
when running MG5_aMC later.
]


libsushiFH.a will be in /path/to/SusHi/SusHi-X.X.X/lib

4. execute script
- go into source folder of the ggH modifications
> cd /path/to/MG5_aMC/MG5_aMC_v2_1_2/src_mod_ggH

- start script to add MSSM (and 2HDM) capabilities to ggH-folder
> ./set_up_ggH_MSSM_script.pl /path/to/MG5_aMC/MG5_aMC_v2_1_2/ggH-folder /path/to/SusHi/SusHi-X.X.X/lib /path/to/FeynHiggs/FeynHiggs-X.X.X/<prefix>/lib(64)

This modifies the appropiate files in the ggH-folder and links 
libsushiFH.a and libFH.a to ggH-folder/lib.
Note: It is advisable to use absolute paths, however, relative paths 
should work as well.

----------------------------------------------------------------------
----------------------------------------------------------------------

[
alternative 4. execute script and link by hand
- go into source folder of the ggH modifications
> cd /path/to/MG5_aMC/MG5_aMC_v2_1_2/src_mod_ggH

- start script to add MSSM (and 2HDM) capabilities to ggH-folder
> ./set_up_ggH_MSSM_script.pl /path/to/MG5_aMC/MG5_aMC_v2_1_2/ggH-folder
> ENTER
> ENTER

- go into lib folder of the ggH-folder
> cd /path/to/MG5_aMC/MG5_aMC_v2_1_2/ggH-folder/lib

- link SusHi and FeynHiggs by hand
> ln -ns /path/to/SusHi/SusHi-X.X.X/lib/libsushiFH.a .
> ln -ns /path/to/FeynHiggs/FeynHiggs-X.X.X/<prefix>/lib/libFH.a .
]

5. compile and run MG5_aMC
> cd /path/to/MG5_aMC/MG5_aMC_v2_1_2/ggH-folder

- for fixed order
> ./bin/calculate_xsect
> ENTER

- for event generation
> ./bin/generate_events
> ENTER
> ENTER

To confirm the result of the total cross section: when you don't change 
the cards it should be compatible with 3.235e+01 +- 2.3e-01 pb (13 TeV).
Changing only the machine energy to 8 TeV: 1.438e+01 +- 8.7e-03 pb